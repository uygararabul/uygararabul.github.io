"use strict";var Cell=function(a,b){this.nextState=a||!1,this.currentState=a||!1,this.nextActiveNeighbors=0,this.currentActiveNeighbors=b||0},Grid=function(a,b){a+=2,b+=2,this.dimX=a,this.dimY=b,this.grid=Array.apply(null,Array(b)).map(function(){return Array.apply(null,Array(a)).map(function(){return new Cell(!1,0)})})};Grid.prototype.setCell=function(a,b){a++,b++,this.grid[b-1][a-1].currentActiveNeighbors++,this.grid[b-1][a].currentActiveNeighbors++,this.grid[b-1][a+1].currentActiveNeighbors++,this.grid[b-1][a-1].nextActiveNeighbors++,this.grid[b-1][a].nextActiveNeighbors++,this.grid[b-1][a+1].nextActiveNeighbors++,this.grid[b][a-1].currentActiveNeighbors++,this.grid[b][a+1].currentActiveNeighbors++,this.grid[b][a-1].nextActiveNeighbors++,this.grid[b][a+1].nextActiveNeighbors++,this.grid[b+1][a-1].currentActiveNeighbors++,this.grid[b+1][a].currentActiveNeighbors++,this.grid[b+1][a+1].currentActiveNeighbors++,this.grid[b+1][a-1].nextActiveNeighbors++,this.grid[b+1][a].nextActiveNeighbors++,this.grid[b+1][a+1].nextActiveNeighbors++,this.grid[b][a].currentState=!0},Grid.prototype.clearCell=function(a,b){a++,b++,this.grid[b-1][a-1].currentActiveNeighbors--,this.grid[b-1][a].currentActiveNeighbors--,this.grid[b-1][a+1].currentActiveNeighbors--,this.grid[b][a-1].currentActiveNeighbors--,this.grid[b][a+1].currentActiveNeighbors--,this.grid[b+1][a-1].currentActiveNeighbors--,this.grid[b+1][a].currentActiveNeighbors--,this.grid[b+1][a+1].currentActiveNeighbors--,this.grid[b][a].currentState=!1},Grid.prototype.calculateNextState=function(a,b){a++,b++;var c=0,d=this.grid[b][a];d.nextState=d.currentState,d.currentState?(d.currentActiveNeighbors<2||d.currentActiveNeighbors>3)&&(c=-1,d.nextState=!1):3===d.currentActiveNeighbors&&(c=1,d.nextState=!0),c&&(this.grid[b-1][a-1].nextActiveNeighbors+=c,this.grid[b-1][a].nextActiveNeighbors+=c,this.grid[b-1][a+1].nextActiveNeighbors+=c,this.grid[b][a-1].nextActiveNeighbors+=c,this.grid[b][a+1].nextActiveNeighbors+=c,this.grid[b+1][a-1].nextActiveNeighbors+=c,this.grid[b+1][a].nextActiveNeighbors+=c,this.grid[b+1][a+1].nextActiveNeighbors+=c)},Grid.prototype.print=function(){for(var a="",b=1;b<this.dimY-1;b++){for(var c=1;c<this.dimX-1;c++)a=a+this.grid[b][c].currentState+", ";a+="\n"}console.log(a)},Grid.prototype.printNeighbors=function(){for(var a="",b=1;b<this.dimY-1;b++){for(var c=1;c<this.dimX-1;c++)a=a+this.grid[b][c].currentActiveNeighbors+", ";a+="\n"}console.log(a)},Grid.prototype.forEach=function(a){var b,c;for(b=1;b<this.dimY-2;b++)for(c=1;c<this.dimX-2;c++)a(this.grid[b][c],c-1,b-1)},Grid.prototype.updateCell=function(a,b){var c=this.grid[b+1][a+1];c.currentState=c.nextState,c.currentActiveNeighbors=c.nextActiveNeighbors},Grid.prototype.calculateAll=function(){var a=this;this.forEach(function(b,c,d){(b.currentState||b.currentActiveNeighbors)&&a.calculateNextState(c,d)})},Grid.prototype.updateAll=function(){var a=this;this.forEach(function(b,c,d){a.updateCell(c,d)})},Grid.prototype.tick=function(){this.calculateAll(),this.updateAll()},Grid.prototype.cellState=function(a,b){return this.grid[b+1][a+1].currentState};var GameOfLife=function(a,b){this.xDim=a,this.yDim=b,this.grid=new Grid(a,b)};GameOfLife.prototype.createGrid=function(a,b){return new Grid(a,b)},GameOfLife.prototype.forEach=function(a){var b,c;for(c=0;c<this.yDim;c++)for(b=0;b<this.xDim;b++)a(this.grid.cellState(b,c),b,c)},GameOfLife.prototype.randomize=function(a){var b=this;this.grid=this.createGrid(this.xDim,this.yDim),this.forEach(function(c,d,e){Math.random()<a&&b.grid.setCell(d,e)})},GameOfLife.prototype.printState=function(){this.grid.print()},GameOfLife.prototype.printNeighbors=function(){this.grid.printNeighbors()},GameOfLife.prototype.tick=function(){this.grid.tick()};